pico-8 cartridge // http://www.pico-8.com
version 34
__lua__

printh('debug started','debug',true)
function debug(s)
 printh(tostr(s),'debug',false)
end

dudex=64
dudey=64
dudeax=0
dudeay=0
dudeonground=nil
dudeframe=0

level={}

for _i=0,1023 do
 local _x,_y=_i&31,_i\32
 local _px=sget(_x,_y)
 if _px == 1 then
  dudex=_x*4
  dudey=_y*4
  _px=0
 elseif px == 2 then
  -- add enemy
 elseif px == 5 then
  -- add ladder
 elseif px == 7 then
  -- add coin
 elseif px == 8 then
  -- add upward spikes
 elseif px == 9 then
  -- add downward spikes
 elseif px == 11 then
  -- add exit
 end

 level[_i]=_px
end

function _update60()
 if btn(1) then
  dudeax+=.12
 elseif btn(0) then
  dudeax-=.12
 else
  dudeax*=0.8
 end

 local _jumpinput=btn(4)
 local _runinput=btn(5)

 local _duderightsens=pget(dudex+3,dudey+2)
 local _dudeleftsens=pget(dudex-1,dudey+2)
 if _duderightsens == 0 and dudeax > 0 then
  dudeax=0
 end
 if _dudeleftsens == 0 and dudeax < 0 then
  dudeax=0
 end

 local _dudefloorsens=pget(dudex+1,dudey+3)
 dudeonground=_dudefloorsens == 0
 if dudeay < 0 and not dudeonground then
  dudeay+=.15
 elseif dudeay >= 0 and not dudeonground then
  dudeay+=.08
 elseif dudeay > 0 then
  dudeay=0
 end

 if dudeonground and _jumpinput then
  dudeay=-1.6
 end

 local _duderoofsens=pget(dudex+1,dudey-1)
 if _duderoofsens != 14 and dudeay < 0 then
  dudeay=0
 end

 local _xlimit=.5
 if _runinput then
  _xlimit=mid(.5,_xlimit+.05,.8)
  if dudeonground then
   _xlimit=.9
  end
 end

 dudeax=mid(-_xlimit,dudeax,_xlimit)
 dudeay=mid(-1.6,dudeay,1)

 dudeframe+=abs(dudeax)*0.55
 if dudeframe >= 3 then
  dudeframe=0
 end
 if abs(dudeax) <= 0.05 then
  dudeframe=0
 end

 dudex+=dudeax
 dudey+=dudeay

end

function _draw()
 cls(14)

 for _i=0,1023 do
  local _x,_y=_i&31,_i\32
  local _block=level[_i]
  if _block == 14 then
   rectfill(_x*4,_y*4,_x*4+3,_y*4+3,0)
  end
 end

 local _frame=dudeframe
 if not dudeonground then
  _frame=3
  if dudeay >= 0 then
   _frame=4
  end
 end

 sspr(0+flr(_frame)*3,120,3,3,dudex,dudey,3,3,dudeax < 0)
end


__gfx__
eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e70000eeeee9999eeeeeeeeeeeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e00000000000000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e00200000010000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e0eeee000eee000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e007ee000eee000000e00020000200ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000ee888eeeeeee88eeeeee50eeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000e0000000007e0000000050e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000e0000700eeee0000000050e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000eee0000000000000000050e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000eee0000000002000000050e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e000eeeeeee000eeee005eeeeee00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000e0000000005e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000e0000000005e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000020000005e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000eeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000eeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000ee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000eeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000eeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000eeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000eeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000eeeeeeee000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01001001001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01011001101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10101011001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
